---
title: 熬夜在VPS简单搭了个frp内网穿透web服务
date: 2019-05-02 11:56:22
tags: [frp]
---

## 搭建成功 : )

http://ww1.sinaimg.cn/large/00655MmOgy1g2mbbs6c3nj31gc13qkjl.jpg

## 回顾一下

小白前几天发了一个帖子，简单调研了一下大佬们平时用服务器来干啥，大多数的答案基本如下：  
1.闲置、吃灰
2.搭梯子、frp 内网穿透
3.测试服务器
4.API 调用
5.等等更加高级的玩法
这里贴一下之前的帖子 https://www.v2ex.com/t/559909#reply93

## 为什么瞎几把搞

然后我琢磨了一下，觉得吃灰的话还不如自己搭一个内网穿透，也就是大家口中说的 frp 咯。  
之前我毕业前实习的时候做开发是用花钱去买市场上的一些内网穿透的产品，之前用的是 natapp，开始用免费的。 
结果可想而知，那速度慢的一批。于是买了个 10 元 /月的套餐，流量勉强还能接受吧，基本用于微信开发，大家知道的啦，sbox 沙盒那边配置一下开发起来以及测试比较方便，免得每次都得更新到线上才可以测试，或者说更新到测试服务器，这样开销有点大，所以那会就这样搞。后来业务逐渐少了，自己也买了个阿里云的小学机，虽然尿管，但是自己搭搭博客还是🆗的。这里就不扯淡了，有点丢人，这里高手如云，大家给个面子。  

## 瞎几把搞

搭建这个 frp 的公网服务器我是选择了我闲置吃灰的 VPS,搬瓦工买的，$19.99/year。现在估计玩蛇了，上次看了一下，有点贵了，我有点怕不能续费。那么平时只是翻墙，所以打算就拿它开刀呗。

### 流程

- 公网服务器安装最新版本的 release，根据 arch。  
- 配置 frps.ini
- 测试连接
- 内网同样安装相同版本的 frp
- 配置 frpc.ini （注意端口统一的问题）
- 阿里云添加一个新的域名
- 域名解析到自己的公网 ip
- 由于要让外网访问到内网，所以在服务器增加一个虚拟域名。（ root 填自己内网的项目地址即可）
- 内网测试连接
- 收工

其实过程中遇到一些小问题，官方 issue 也很多人提到过，类似于：
`
[W] [service.go:82] login to server failed: dial tcp xxx.xxx.xxx.xxx:7000: connect: connection timed out
`

交流贴，纯粹跟大家分享一下，并不是炫技哈~~